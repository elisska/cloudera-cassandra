<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_51) on Thu Apr 28 18:37:28 UTC 2016 -->
<title>Ref (apache-cassandra API)</title>
<meta name="date" content="2016-04-28">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Ref (apache-cassandra API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Ref.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/cassandra/utils/concurrent/OpOrder.Group.html" title="class in org.apache.cassandra.utils.concurrent"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../org/apache/cassandra/utils/concurrent/RefCounted.html" title="interface in org.apache.cassandra.utils.concurrent"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/cassandra/utils/concurrent/Ref.html" target="_top">Frames</a></li>
<li><a href="Ref.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.cassandra.utils.concurrent</div>
<h2 title="Class Ref" class="title">Class Ref&lt;T&gt;</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.cassandra.utils.concurrent.Ref&lt;T&gt;</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../org/apache/cassandra/utils/concurrent/RefCounted.html" title="interface in org.apache.cassandra.utils.concurrent">RefCounted</a>&lt;T&gt;</dd>
</dl>
<hr>
<br>
<pre>public final class <span class="strong">Ref&lt;T&gt;</span>
extends java.lang.Object
implements <a href="../../../../../org/apache/cassandra/utils/concurrent/RefCounted.html" title="interface in org.apache.cassandra.utils.concurrent">RefCounted</a>&lt;T&gt;</pre>
<div class="block">An object that needs ref counting does the two following:
   - defines a Tidy object that will cleanup once it's gone,
     (this must retain no references to the object we're tracking (only its resources and how to clean up))
 Then, one of two options:
 1) Construct a Ref directly pointing to it, and always use this Ref; or
 2)
   - implements RefCounted
   - encapsulates a Ref, we'll call selfRef, to which it proxies all calls to RefCounted behaviours
   - users must ensure no references to the selfRef leak, or are retained outside of a method scope.
     (to ensure the selfRef is collected with the object, so that leaks may be detected and corrected)

 This class' functionality is achieved by what may look at first glance like a complex web of references,
 but boils down to:

 Target --> selfRef --> [Ref.State] <--> Ref.GlobalState --> Tidy
                                             ^
                                             |
 Ref ----------------------------------------
                                             |
 Global -------------------------------------

 So that, if Target is collected, Impl is collected and, hence, so is selfRef.

 Once ref or selfRef are collected, the paired Ref.State's release method is called, which if it had
 not already been called will update Ref.GlobalState and log an error.

 Once the Ref.GlobalState has been completely released, the Tidy method is called and it removes the global reference
 to itself so it may also be collected.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="nested_classes_inherited_from_class_org.apache.cassandra.utils.concurrent.RefCounted">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from interface&nbsp;org.apache.cassandra.utils.concurrent.<a href="../../../../../org/apache/cassandra/utils/concurrent/RefCounted.html" title="interface in org.apache.cassandra.utils.concurrent">RefCounted</a></h3>
<code><a href="../../../../../org/apache/cassandra/utils/concurrent/RefCounted.Tidy.html" title="interface in org.apache.cassandra.utils.concurrent">RefCounted.Tidy</a></code></li>
</ul>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html#DEBUG_ENABLED">DEBUG_ENABLED</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html#Ref(T, org.apache.cassandra.utils.concurrent.RefCounted.Tidy)">Ref</a></strong>(<a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="type parameter in Ref">T</a>&nbsp;referent,
   <a href="../../../../../org/apache/cassandra/utils/concurrent/RefCounted.Tidy.html" title="interface in org.apache.cassandra.utils.concurrent">RefCounted.Tidy</a>&nbsp;tidy)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html#close()">close</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html#ensureReleased()">ensureReleased</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.Throwable</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html#ensureReleased(java.lang.Throwable)">ensureReleased</a></strong>(java.lang.Throwable&nbsp;accumulate)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="type parameter in Ref">T</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html#get()">get</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html#globalCount()">globalCount</a></strong>()</code>
<div class="block">A convenience method for reporting:</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html#printDebugInfo()">printDebugInfo</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="class in org.apache.cassandra.utils.concurrent">Ref</a>&lt;<a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="type parameter in Ref">T</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html#ref()">ref</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html#release()">release</a></strong>()</code>
<div class="block">Must be called exactly once, when the logical operation for which this Ref was created has terminated.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="class in org.apache.cassandra.utils.concurrent">Ref</a>&lt;<a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="type parameter in Ref">T</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html#tryRef()">tryRef</a></strong>()</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="DEBUG_ENABLED">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DEBUG_ENABLED</h4>
<pre>public static final&nbsp;boolean DEBUG_ENABLED</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="Ref(java.lang.Object,org.apache.cassandra.utils.concurrent.RefCounted.Tidy)">
<!--   -->
</a><a name="Ref(T, org.apache.cassandra.utils.concurrent.RefCounted.Tidy)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Ref</h4>
<pre>public&nbsp;Ref(<a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="type parameter in Ref">T</a>&nbsp;referent,
   <a href="../../../../../org/apache/cassandra/utils/concurrent/RefCounted.Tidy.html" title="interface in org.apache.cassandra.utils.concurrent">RefCounted.Tidy</a>&nbsp;tidy)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="release()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>release</h4>
<pre>public&nbsp;void&nbsp;release()</pre>
<div class="block">Must be called exactly once, when the logical operation for which this Ref was created has terminated.
 Failure to abide by this contract will result in an error (eventually) being reported, assuming a
 hard reference to the resource it managed is not leaked.</div>
</li>
</ul>
<a name="ensureReleased(java.lang.Throwable)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ensureReleased</h4>
<pre>public&nbsp;java.lang.Throwable&nbsp;ensureReleased(java.lang.Throwable&nbsp;accumulate)</pre>
</li>
</ul>
<a name="ensureReleased()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ensureReleased</h4>
<pre>public&nbsp;void&nbsp;ensureReleased()</pre>
</li>
</ul>
<a name="close()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre>public&nbsp;void&nbsp;close()</pre>
</li>
</ul>
<a name="get()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>get</h4>
<pre>public&nbsp;<a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="type parameter in Ref">T</a>&nbsp;get()</pre>
</li>
</ul>
<a name="tryRef()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tryRef</h4>
<pre>public&nbsp;<a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="class in org.apache.cassandra.utils.concurrent">Ref</a>&lt;<a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="type parameter in Ref">T</a>&gt;&nbsp;tryRef()</pre>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/apache/cassandra/utils/concurrent/RefCounted.html#tryRef()">tryRef</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/apache/cassandra/utils/concurrent/RefCounted.html" title="interface in org.apache.cassandra.utils.concurrent">RefCounted</a>&lt;<a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="type parameter in Ref">T</a>&gt;</code></dd>
<dt><span class="strong">Returns:</span></dt><dd>the a new Ref() to the managed object, incrementing its refcount, or null if it is already released</dd></dl>
</li>
</ul>
<a name="ref()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ref</h4>
<pre>public&nbsp;<a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="class in org.apache.cassandra.utils.concurrent">Ref</a>&lt;<a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="type parameter in Ref">T</a>&gt;&nbsp;ref()</pre>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../org/apache/cassandra/utils/concurrent/RefCounted.html#ref()">ref</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../org/apache/cassandra/utils/concurrent/RefCounted.html" title="interface in org.apache.cassandra.utils.concurrent">RefCounted</a>&lt;<a href="../../../../../org/apache/cassandra/utils/concurrent/Ref.html" title="type parameter in Ref">T</a>&gt;</code></dd>
</dl>
</li>
</ul>
<a name="printDebugInfo()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>printDebugInfo</h4>
<pre>public&nbsp;java.lang.String&nbsp;printDebugInfo()</pre>
</li>
</ul>
<a name="globalCount()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>globalCount</h4>
<pre>public&nbsp;int&nbsp;globalCount()</pre>
<div class="block">A convenience method for reporting:</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the number of currently extant references globally, including the shared reference</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Ref.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/cassandra/utils/concurrent/OpOrder.Group.html" title="class in org.apache.cassandra.utils.concurrent"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../org/apache/cassandra/utils/concurrent/RefCounted.html" title="interface in org.apache.cassandra.utils.concurrent"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/cassandra/utils/concurrent/Ref.html" target="_top">Frames</a></li>
<li><a href="Ref.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &copy; 2016 The Apache Software Foundation</small></p>
</body>
</html>
